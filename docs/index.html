<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="UTF-8">
  <title>Project 1</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <script type="text/javascript" src="d3/d3.v3.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/1.13.0/d3-legend.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
  <style type="text/css">
      #exe1 {
      position: relative;
      height: auto;
      margin: auto;
    }

    #exe2 {
      position: relative;
      height: auto;
      margin: auto;
    }

    p {
      font-size: 15px;
      font-family: Helvetica, Arial, sans-serif;
    }

    div.bar {
      display: inline-block;
      width: 20px;
      height: 75px;
      background-color: teal;
      margin-right: 2px;
    }

    .axis path,
    .axis line {
      fill: none;
      stroke: black;
      shape-rendering: crispEdges;
    }

    .axis text {
      font-family: sans-serif;
      font-size: 11px;
    }

    .labels:hover {
      fill: red;
      font-size: 20px;
      font-weight: bold;
    }
    
    g.legendOrdinal {
      font-family: 'Ubuntu', sans-serif;
    }

    .wrapper {
      text-align: center;
  </style>
<<<<<<< HEAD
</head>

<body>
  <section class="page-header">
    <h1 class="project-name">Assignment 2</h1>
    <h2 class="project-tagline"></h2>
    <a href="https://github.com/Rickeyhb/socialdataanalysis2017" class="btn">View on Github</a>
  </section>

  <section class="main-content">

    <div id="exe2">
      <h1>Assignment 2B: Visualizing Geodata</h1>
      <p> The graph below shows prostitution in San Fransico clustered using the k-means algorithm. </p>
      <div class='wrapper' id='geoMapGoesHere'> </div>
      <script type="text/javascript">
        var w = 1000;
        var h = 600;
        var k = 2;
        var kprv = 2;
        var colorMapping = {}

        colorMapping[0] = 'purple';
        colorMapping[1] = 'green';
        colorMapping[2] = 'red';
        colorMapping[3] = 'blue';
        colorMapping[4] = 'skyblue';
        colorMapping[5] = 'orange'

        var crimes = [];

        var projection = d3.geo.mercator()
          .center([-73.94, 40.70])
          .translate([w / 2, h / 2])
          .scale([60000]);

        var path = d3.geo.path()
          .projection(projection);

        var geoMap = d3.select('#geoMapGoesHere')
          .append('svg')
          .attr("width", w)
          .attr("height", h);


        d3.json("dataset/NYC.geojson", function(json) {
          geoMap.append('g')
            .attr('class', 'map')

          geoMap.selectAll(".map")
            .selectAll('path')
            .data(json.features)
            .enter()
            .append("path")
            .attr("d", path);

          d3.csv('dataset/knnGridResult.csv', function(d) {
            for (var i = 0; i < d.length; i++) {
              crimes.push([Number(d[i]['lat']), Number(d[i]['lon']), Number(d[i]['cat'])])
            }
            geoMap.append('g')
              .attr('class', 'dots')

            geoMap.selectAll('.dots')
              .selectAll('.dot')
              .data(crimes)
              .enter()
              .append('rect')
              .attr('x', function(d) {
                return projection([d[1], d[0]])[0] - 3;
              })
              .attr('y', function(d) {
                return projection([d[1], d[0]])[1] - 3;
              })
              .attr('height',6)
              .attr('width', 6)
              .attr('class', 'dot')
              .style('opacity', 0.8)
              .style('fill', function(d){
                return colorMapping[d[2]];
              });
          });

        var ordinal = d3.scale.ordinal()
          .domain(['PLUMBING','Noise - Commercial', 'Street Light Condition', 'Homeless Person Assistance', 'DOOR/WINDOW'])
          .range(['purple', 'green', 'red', 'blue', 'skyblue']);

        geoMap.append("g")
          .attr('class', 'legendOrdinal')
          .attr('transform', 'translate(150,150)');

        var legendOrdinal = d3.legend.color()
          .shape('path', d3.svg.symbol().type('square').size(150)())
          .shapePadding(10)
          .scale(ordinal)

        geoMap.select('.legendOrdinal')
          .call(legendOrdinal)

        });
      </script>
      <p>Note: Think carefully about how you can minimize the size of the file containing the data. My file is around 700KB. Why is the size of the file important?</p>
      <p>The size of our file is around 725KB. Data structure was a simple csv file containing each crimes' latitude, longitude, and their cluster id corresponds to K values.</p>
      <p> The size of data matters since every time we change K, we have to process the data.</p>
    </div>

    <footer class="site-footer">
    </footer>
  </section>
</body>
